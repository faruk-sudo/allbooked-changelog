# Local DB quickstart (see README.md for full setup and ops docs):
# 1) Start DB: docker run --name allbooked-changelog-pg -e POSTGRES_PASSWORD=postgres -e POSTGRES_USER=postgres -e POSTGRES_DB=allbooked_changelog -p 5432:5432 -d postgres:16
# 2) Run migrations: npm run db:migrate
# 3) Optional dev seed: npm run db:seed:dev
# 4) Optional smoke check: npm run db:smoke-check

PORT=3000
# Keep OFF by default; enable only for emergency rollback.
WHATS_NEW_KILL_SWITCH=false
WHATS_NEW_ALLOWLIST_ENABLED=true
WHATS_NEW_ALLOWLIST_TENANT_IDS=tenant-alpha,tenant-beta
# Prefer stable user IDs for publisher authz. Add/remove IDs here and restart the app.
# Email allowlist is exact-match fallback only (avoid unless user IDs are unavailable).
WHATS_NEW_PUBLISHER_ALLOWLIST_USER_IDS=publisher-1
WHATS_NEW_PUBLISHER_ALLOWLIST_EMAILS=
WHATS_NEW_DEV_AUTH_BYPASS=true
WHATS_NEW_DEV_USER_ID=dev-admin-1
WHATS_NEW_DEV_USER_ROLE=ADMIN
WHATS_NEW_DEV_TENANT_ID=tenant-alpha
WHATS_NEW_DEV_USER_EMAIL=
# Public changelog rollout toggles (safe defaults; keep noindex=true for first launch)
# Controls public /changelog pages and /rss feed.
PUBLIC_CHANGELOG_ENABLED=false
PUBLIC_CHANGELOG_NOINDEX=true
# Reuse existing strict HTML CSP profile for public HTML surfaces (e.g. /changelog*)
PUBLIC_SURFACE_CSP_ENABLED=true
# Canonical absolute URL source for public links (preferred over BASE_URL)
PUBLIC_SITE_URL=https://updates.example.com
# Backward-compatible fallback if PUBLIC_SITE_URL is unset.
BASE_URL=
# API rate limits (per app instance, in-memory store)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_READ_PER_MIN=120
RATE_LIMIT_WRITE_PER_MIN=30
# CSP + security headers (Whatâ€™s New HTML surfaces)
# In production, keep WHATS_NEW_CSP_REPORT_ONLY=false to enforce.
WHATS_NEW_CSP_REPORT_ONLY=true
# Comma-separated CSP sources. Keep strict unless embedding is required.
CSP_FRAME_ANCESTORS='none'
# Extend only when external API/image hosts are explicitly required.
CSP_CONNECT_SRC='self'
CSP_IMG_SRC='self',data:,https:
DATABASE_URL=postgres://postgres:postgres@localhost:5432/allbooked_changelog
DATABASE_SSL=false
DATABASE_SSL_REJECT_UNAUTHORIZED=true
